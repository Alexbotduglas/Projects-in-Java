import java.util.*; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–∫–µ—Ç java.util, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç List, ArrayList –∏ Scanner

public class Main { // –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞

    // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø –°–ï–ö–£–ù–î–û–ú–ï–†–ê ---

    private long totalElapsedMillis = 0; // –û–±—â–µ–µ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ—à–ª–æ (–Ω–∞–∫–æ–ø–ª–µ–Ω–æ –≤–æ –≤—Ä–µ–º—è –ø–∞—É–∑)
    private long lastStartTime = 0;      // –ú–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö), –∫–æ–≥–¥–∞ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –±—ã–ª –∑–∞–ø—É—â–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑
    private boolean running = false;     // –§–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç
    // –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ –±—ã–ª –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –∫–∞–∂–¥—ã–π –∫—Ä—É–≥
    private final List<Long> laps = new ArrayList<>();

    // --- –û–°–ù–û–í–ù–ê–Ø –¢–û–ß–ö–ê –í–•–û–î–ê ---

    public static void main(String[] args) { // –ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º try-with-resources –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è Scanner
        try (Scanner scanner = new Scanner(System.in)) { // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç Scanner –¥–ª—è —á—Ç–µ–Ω–∏—è –≤–≤–æ–¥–∞
            new Main().run(scanner); // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Main –∏ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ run
        } // Scanner –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –±–ª–æ–∫–∞ try
    }

    // --- –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ –ü–†–û–ì–†–ê–ú–ú–´ ---

    public void run(Scanner scanner) { // –ú–µ—Ç–æ–¥, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø—Ä–æ–≥—Ä–∞–º–º—ã
        System.out.println("--- ‚è±Ô∏è –ü–†–û–°–¢–û–ô –°–ï–ö–£–ù–î–û–ú–ï–† ---"); // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

        while (true) { // –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—ã–±–µ—Ä–µ—Ç "–í—ã—Ö–æ–¥"
            long currentTime = getCurrentTime(); // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –æ–±—â–µ–µ –≤—Ä–µ–º—è
            String status = running ? "–†–ê–ë–û–¢–ê–ï–¢" : "–û–°–¢–ê–ù–û–í–õ–ï–ù"; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –¥–ª—è –≤—ã–≤–æ–¥–∞

            // –í—ã–≤–æ–¥ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å
            System.out.printf("\n[ %s | –í—Ä–µ–º—è: %s ]\n", status, formatTime(currentTime));

            showMenu(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

            System.out.print("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: "); // –ó–∞–ø—Ä–æ—Å –≤–≤–æ–¥–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            String input = scanner.nextLine().trim(); // –ß–∏—Ç–∞–µ–º —Å—Ç—Ä–æ–∫—É, —É–¥–∞–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã –ø–æ –∫—Ä–∞—è–º

            if (handleInput(input)) break; // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–≤–æ–¥; –µ—Å–ª–∏ true, –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
        }
    }

    // --- –û–ë–†–ê–ë–û–¢–ö–ê –í–í–û–î–ê ---

    private boolean handleInput(String input) { // –ú–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        switch (input.toLowerCase()) { // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤–≤–æ–¥, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Ä–µ–≥–∏—Å—Ç—Ä
            case "1", "—Å—Ç–∞—Ä—Ç" -> startTimer(); // –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
            case "2", "–ø–∞—É–∑–∞" -> pauseTimer(); // –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–∞—É–∑—ã
            case "3", "—Å–±—Ä–æ—Å" -> resetTimer(); // –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±—Ä–æ—Å–∞
            case "4", "–∫—Ä—É–≥" -> addLap();      // –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫—Ä—É–≥–∞
            case "0", "–≤—ã—Ö–æ–¥" -> {            // –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã—Ö–æ–¥–∞
                System.out.println("–î–æ —Å–≤–∏–¥–∞–Ω–∏—è!"); // –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
                return true; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–∏–∫–ª –≤ run()
            }
            // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞
            default -> System.out.println("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ 1, 2, 3, 4 –∏–ª–∏ 0.");
        }
        return false; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º false, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ü–∏–∫–ª
    }

    // --- –õ–û–ì–ò–ö–ê –°–ï–ö–£–ù–î–û–ú–ï–†–ê ---

    private void startTimer() { // –ú–µ—Ç–æ–¥ –¥–ª—è –∑–∞–ø—É—Å–∫–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä–∞
        if (!running) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —É–∂–µ
            lastStartTime = System.currentTimeMillis(); // –§–∏–∫—Å–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –∫–∞–∫ –º–æ–º–µ–Ω—Ç —Å—Ç–∞—Ä—Ç–∞
            running = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
            System.out.println("‚ñ∂ –ó–∞–ø—É—â–µ–Ω."); // –°–æ–æ–±—â–µ–Ω–∏–µ
        } else {
            System.out.println("‚ö† –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç."); // –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ —É–∂–µ –∑–∞–ø—É—â–µ–Ω
        }
    }

    private void pauseTimer() { // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ –ø–∞—É–∑—É
        if (running) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º—è, –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å—Ç–∞—Ä—Ç–∞, –∫ –æ–±—â–µ–º—É –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
            totalElapsedMillis += System.currentTimeMillis() - lastStartTime;
            running = false; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
            System.out.println("‚è∏ –ü–∞—É–∑–∞."); // –°–æ–æ–±—â–µ–Ω–∏–µ
        } else {
            System.out.println("‚ö† –ù–µ –∑–∞–ø—É—â–µ–Ω."); // –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
        }
    }

    private void resetTimer() { // –ú–µ—Ç–æ–¥ –¥–ª—è —Å–±—Ä–æ—Å–∞
        running = false; // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
        totalElapsedMillis = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
        lastStartTime = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞
        laps.clear(); // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫—Ä—É–≥–æ–≤
        System.out.println("üîÑ –°–±—Ä–æ—à–µ–Ω."); // –°–æ–æ–±—â–µ–Ω–∏–µ
    }

    private void addLap() { // –ú–µ—Ç–æ–¥ –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∫—Ä—É–≥–∞
        if (running) { // –ú–æ–∂–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∫—Ä—É–≥, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
            long currentTotalTime = getCurrentTime(); // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –æ–±—â–µ–µ –≤—Ä–µ–º—è
            laps.add(currentTotalTime); // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ç–æ –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤ —Å–ø–∏—Å–æ–∫ –∫—Ä—É–≥–æ–≤

            long lapTime = getLapTime(currentTotalTime); // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è, –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫—Ä—É–≥–∞
            // –í—ã–≤–æ–¥–∏–º –Ω–æ–º–µ—Ä –∫—Ä—É–≥–∞, –≤—Ä–µ–º—è —ç—Ç–æ–≥–æ –∫—Ä—É–≥–∞ –∏ –æ–±—â–µ–µ –≤—Ä–µ–º—è
            System.out.printf("‚è± –ö—Ä—É–≥ %d: %s (–û–±—â–µ–µ: %s)\n",
                    laps.size(), formatTime(lapTime), formatTime(currentTotalTime));
        } else {
            System.out.println("‚ùå –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∫—Ä—É–≥."); // –û—à–∏–±–∫–∞, –µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω
        }
    }

    // --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ---

    private long getCurrentTime() { // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        if (running) { // –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è + –≤—Ä–µ–º—è, –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞
            return totalElapsedMillis + (System.currentTimeMillis() - lastStartTime);
        } else { // –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            return totalElapsedMillis;
        }
    }

    private long getLapTime(long lapTimeTotal) { // –ú–µ—Ç–æ–¥ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫—Ä—É–≥–∞
        int index = laps.indexOf(lapTimeTotal); // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –∫—Ä—É–≥–∞ –≤ —Å–ø–∏—Å–∫–µ

        // –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–≥–æ –∫—Ä—É–≥–∞ (–∏–Ω–¥–µ–∫—Å 0) —Ä–∞–≤–Ω–æ –µ–≥–æ –æ–±—â–µ–º—É –≤—Ä–µ–º–µ–Ω–∏ (—Ç–∞–∫ –∫–∞–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –Ω–µ—Ç)
        if (index <= 0) return lapTimeTotal;

        // –í—Ä–µ–º—è —Ç–µ–∫—É—â–µ–≥–æ –∫—Ä—É–≥–∞ = –û–±—â–µ–µ –≤—Ä–µ–º—è —Å–µ–π—á–∞—Å - –û–±—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫—Ä—É–≥–∞
        return lapTimeTotal - laps.get(index - 1);
    }

    private String formatTime(long millis) { // –ú–µ—Ç–æ–¥ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ —Å—Ç—Ä–æ–∫—É "–ú–ú:–°–°.–ú–ú–ú"
        // –£–ø—Ä–æ—â–∞–µ–º: —Ç–æ–ª—å–∫–æ –º–∏–Ω—É—Ç—ã, —Å–µ–∫—É–Ω–¥—ã –∏ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
        long minutes = (millis / 60000) % 60; // –í—ã—á–∏—Å–ª—è–µ–º –º–∏–Ω—É—Ç—ã (—Å –æ—Å—Ç–∞—Ç–∫–æ–º –æ—Ç —á–∞—Å–∞)
        long seconds = (millis / 1000) % 60; // –í—ã—á–∏—Å–ª—è–µ–º —Å–µ–∫—É–Ω–¥—ã (—Å –æ—Å—Ç–∞—Ç–∫–æ–º –æ—Ç –º–∏–Ω—É—Ç—ã)
        long ms = millis % 1000; // –í—ã—á–∏—Å–ª—è–µ–º –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (—Å –æ—Å—Ç–∞—Ç–∫–æ–º –æ—Ç —Å–µ–∫—É–Ω–¥—ã)

        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É —Å –Ω—É–ª—è–º–∏ –≤ –Ω–∞—á–∞–ª–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è
        return String.format("%02d:%02d.%03d", minutes, seconds, ms);
    }

    private void showMenu() { // –ú–µ—Ç–æ–¥ –¥–ª—è –≤—ã–≤–æ–¥–∞ –º–µ–Ω—é –∫–æ–º–∞–Ω–¥
        System.out.println("----------------------------------"); // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
        System.out.println("1: –°—Ç–∞—Ä—Ç | 2: –ü–∞—É–∑–∞ | 3: –°–±—Ä–æ—Å"); // –ö–æ–º–∞–Ω–¥—ã 1, 2, 3
        System.out.println("4: –ö—Ä—É–≥  | 0: –í—ã—Ö–æ–¥"); // –ö–æ–º–∞–Ω–¥—ã 4, 0
        System.out.println("----------------------------------"); // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    }
}
