import java.util.Arrays; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å Arrays –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è)
import java.util.Scanner; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å Scanner –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–æ–Ω—Å–æ–ª–∏

/**
 * –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã "–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏" (Tic-Tac-Toe).
 * –ò–≥—Ä–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–Ω—Å–æ–ª–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤, –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é,
 * –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è (3x3 –∏–ª–∏ 5x5) –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É—Å–ª–æ–≤–∏—è –ø–æ–±–µ–¥—ã (3-–≤-—Ä—è–¥ –∏–ª–∏ 5-–≤-—Ä—è–¥).
 */
public class Main {

    // --- –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï (–ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´) ---

    // –û–±—ä–µ–∫—Ç Scanner, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–π –∫–∞–∫ static final –¥–ª—è –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ –≤—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ.
    private static final Scanner SCANNER = new Scanner(System.in);

    // –§–ª–∞–≥, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–∞–º—ã–º –≤–Ω–µ—à–Ω–∏–º (–≥–ª–∞–≤–Ω—ã–º) —Ü–∏–∫–ª–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ï—Å–ª–∏ false, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.
    private static boolean continuePlaying = true;

    // –î–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ 3x3.
    private static char[][] board = new char[3][3];

    // –°–∏–º–≤–æ–ª —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ ('X' –∏–ª–∏ 'O'). –ò–≥—Ä–∞ –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 'X'.
    private static char currentPlayer = 'X';

    // –§–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —Ç–µ–∫—É—â–∏–π —Ä–∞—É–Ω–¥ (–ø–æ–±–µ–¥–∞ –∏–ª–∏ –Ω–∏—á—å—è).
    private static boolean gameIsOver = false;

    // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–ø–∞—Å—Ö–∞–ª–∫–∞), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.
    private static boolean secretModeActivated = false;

    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è (3 –¥–ª—è 3x3, 5 –¥–ª—è 5x5).
    private static int boardSize = 3;

    // !!! –ö–õ–Æ–ß–ï–í–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥ –¥–ª—è –ø–æ–±–µ–¥—ã !!!
    // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ 3 (–¥–ª—è 3x3), –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 5 –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–∞—Å—Ö–∞–ª–∫–∏ (–¥–ª—è 5x5).
    private static int winLength = 3;

    // --- –û–°–ù–û–í–ù–û–ô –ú–ï–¢–û–î (–¢–û–ß–ö–ê –í–•–û–î–ê) ---
    public static void main(String[] args) {
        System.out.println("ü§ñ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏!");

        // !!! –í–ù–ï–®–ù–ò–ô –¶–ò–ö–õ: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ú–µ–Ω—é –∏ –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ—Å—Ç—å—é !!!
        // –¶–∏–∫–ª –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤ –º–µ–Ω—é –∏ –∏–≥—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞—É–Ω–¥–æ–≤.
        while (continuePlaying) {

            // 1. –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ù–∞—á–∞—Ç—å/–ü—Ä–∞–≤–∏–ª–∞/–í—ã–π—Ç–∏)
            handleMenuSelection();

            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª "–í—ã–π—Ç–∏" (continuePlaying == false), –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
            if (!continuePlaying) {
                break;
            }

            // 2. –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–≥–æ —Ä–∞—É–Ω–¥–∞ (–≤–æ–∑–≤—Ä–∞—Ç –∫ 3x3)
            resetGame();

            // 3. –ì–õ–ê–í–ù–´–ô –ò–ì–†–û–í–û–ô –¶–ò–ö–õ –û–î–ù–û–ì–û –†–ê–£–ù–î–ê
            // –≠—Ç–æ—Ç —Ü–∏–∫–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø–æ–±–µ–¥–∞, –Ω–∏—á—å—è –∏–ª–∏ –¥–æ—Å—Ä–æ—á–Ω—ã–π –≤—ã—Ö–æ–¥.
            while (!gameIsOver) {
                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ –∫–æ–Ω—Å–æ–ª—å
                printBoard();

                // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ö–æ–¥–∞ –∏–≥—Ä–æ–∫–∞. move —Å–æ–¥–µ—Ä–∂–∏—Ç [—Å—Ç—Ä–æ–∫–∞, —Å—Ç–æ–ª–±–µ—Ü] –∏–ª–∏ —Å–ø–µ—Ü–∫–æ–¥—ã.
                int[] move = getPlayerMove();
                int row = move[0];
                int col = move[1];

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–∞—Å—Ö–∞–ª–∫–∏ (–∫–æ–¥ [-1, -1] –æ—Ç –≤–≤–æ–¥–∞ "JAVA")
                if (row == -1 && col == -1) {
                    activateSecretMode();
                    continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ö–æ–¥, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –∏ –Ω–µ –º–µ–Ω—è—Ç—å –∏–≥—Ä–æ–∫–∞
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—É –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ (–∫–æ–¥ [-2, -2] –æ—Ç –≤–≤–æ–¥–∞ "EXIT")
                if (row == -2 && col == -2) {
                    gameIsOver = true;         // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ä–∞—É–Ω–¥
                    continuePlaying = false;   // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞
                    System.out.println("\nüëã –í—ã—Ö–æ–¥ –∏–∑ –∏–≥—Ä—ã. –°–ø–∞—Å–∏–±–æ!");
                    break;                     // –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ü–∏–∫–ª–∞
                }

                // 4. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ö–æ–¥–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
                if (isValidMove(row, col)) {
                    // –°—Ç–∞–≤–∏–º —Å–∏–º–≤–æ–ª —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é —è—á–µ–π–∫—É
                    board[row][col] = currentPlayer;

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞
                    if (checkWin()) {
                        printBoard();
                        System.out.println("\nüéâ –ò–≥—Ä–æ–∫ " + currentPlayer + " –ø–æ–±–µ–¥–∏–ª, —Å–æ–±—Ä–∞–≤ " + winLength + " –≤ —Ä—è–¥!");
                        gameIsOver = true;
                    } else if (isBoardFull()) {
                        printBoard();
                        System.out.println("\nü§ù –ù–∏—á—å—è! –ü–æ–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ.");
                        gameIsOver = true;
                    } else {
                        // –ï—Å–ª–∏ –∏–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–≥—Ä–æ–∫—É
                        switchPlayer();
                    }
                } else {
                    // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Ö–æ–¥–µ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤–≤–æ–¥–∞)
                    System.out.println("‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ö–æ–¥! –Ø—á–µ–π–∫–∞ –∑–∞–Ω—è—Ç–∞ –∏–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω–µ –ø–æ–ª—è (1-" + (boardSize * boardSize) + "). –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
                }
            }

            // 5. –í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞
            if (gameIsOver && continuePlaying) {
                // –ï—Å–ª–∏ —Ä–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è (–ø–æ–±–µ–¥–∞/–Ω–∏—á—å—è) –∏ –Ω–µ –±—ã–ª–æ –∫–æ–º–∞–Ω–¥—ã EXIT, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –º–µ–Ω—é.
                System.out.println("\n--- –†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–µ–Ω. –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ---");
            }
        }

        System.out.println("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.");
        SCANNER.close(); // –ó–∞–∫—Ä—ã—Ç–∏–µ Scanner'–∞
    }

    // ---------------------------------------------------------------------
    // --- –ú–ï–¢–û–î–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ú–ï–ù–Æ –ò –¶–ò–ö–õ–û–ú –ò–ì–†–´ ---
    // ---------------------------------------------------------------------

    /**
     * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –æ–ø—Ü–∏—è–º–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
     */
    private static void displayMenu() {
        System.out.println("\n===== –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ =====");
        System.out.println("1. üöÄ –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É (3x3, 3 –≤ —Ä—è–¥)");
        System.out.println("2. üìú –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∞–≤–∏–ª–∞");
        System.out.println("3. üö™ –í—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã");
        System.out.print("–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-3): ");
    }

    /**
     * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é.
     */
    private static void handleMenuSelection() {
        // –¶–∏–∫–ª –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—ã–±–µ—Ä–µ—Ç 1, 2 –∏–ª–∏ 3
        while (true) {
            displayMenu();
            String input = SCANNER.next().trim();

            try {
                int choice = Integer.parseInt(input);
                switch (choice) {
                    case 1:
                        return; // –ù–∞—á–∞—Ç—å –∏–≥—Ä—É, –≤—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ –º–µ–Ω—é
                    case 2:
                        showRules(); // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞
                        break;
                    case 3:
                        continuePlaying = false; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –≤—ã—Ö–æ–¥–∞
                        return; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ –º–µ–Ω—é –∏ –∏–∑ –º–µ—Ç–æ–¥–∞
                    default:
                        System.out.println("‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–±–æ—Ä. –í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3.");
                }
            } catch (NumberFormatException e) {
                System.out.println("‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ (1-3).");
            }
        }
    }

    /**
     * –í—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã, –≤–∫–ª—é—á–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–æ–±–µ–¥–µ.
     */
    private static void showRules() {
        System.out.println("\n========== –ü–†–ê–í–ò–õ–ê –ò–ì–†–´ ==========");
        System.out.println("1. –ò–≥—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø–æ–ª–µ 3x3, –¥–ª—è –ø–æ–±–µ–¥—ã –Ω—É–∂–Ω–æ 3 —Å–∏–º–≤–æ–ª–∞ –≤ —Ä—è–¥.");
        System.out.println("2. –•–æ–¥ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞ —è—á–µ–π–∫–∏.");
        System.out.println("3. ‚≠ê –°–ï–ö–†–ï–¢ ‚≠ê: –í–≤–µ–¥–∏—Ç–µ 'JAVA' –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–ª—è –¥–æ 5x5.");
        System.out.println("4. üåü –í–ê–ñ–ù–û üåü: –ù–∞ –ø–æ–ª–µ 5x5 –¥–ª—è –ø–æ–±–µ–¥—ã –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å 5 —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥!");
        System.out.println("5. üö™ –î–û–°–†–û–ß–ù–´–ô –í–´–•–û–î: –í–≤–µ–¥–∏—Ç–µ 'EXIT' –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤–º–µ—Å—Ç–æ –Ω–æ–º–µ—Ä–∞ —è—á–µ–π–∫–∏.");
        System.out.println("===================================");
    }

    /**
     * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∏–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é 3x3.
     */
    private static void resetGame() {
        boardSize = 3;
        winLength = 3; // !!! –£—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∫ 3 –≤ —Ä—è–¥ !!!
        initializeBoard(); // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ 3x3
        currentPlayer = 'X';
        gameIsOver = false;
        secretModeActivated = false;
        System.out.println("\n--- –ù–∞—á–∞—Ç –ù–û–í–´–ô –†–ê–£–ù–î (3x3, 3 –≤ —Ä—è–¥) ---");
    }

    /**
     * –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º: –º–µ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–ª—è –Ω–∞ 5x5 –∏ —É—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã –Ω–∞ 5 –≤ —Ä—è–¥.
     */
    private static void activateSecretMode() {
        if (!secretModeActivated) {
            System.out.println("\n‚≠ê‚≠ê‚≠ê –ü–ê–°–•–ê–õ–ö–ê –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ê! ‚≠ê‚≠ê‚≠ê");
            System.out.println(">>> –ü–æ–ª–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –¥–æ 5x5! –£—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã: 5 –≤ —Ä—è–¥! <<<");

            secretModeActivated = true;
            boardSize = 5; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä
            winLength = 5; // !!! –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤–æ–µ —É—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã: 5 –≤ —Ä—è–¥ !!!
            initializeBoard(); // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ, –±–æ–ª—å—à–æ–µ, –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ
            currentPlayer = 'X'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–≥—Ä–æ–∫–∞ (—Ö–æ–¥ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è)
        } else {
            System.out.println("–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–≥—Ä–∞—Ç—å!");
        }
    }

    // ---------------------------------------------------------------------
    // --- –ú–ï–¢–û–î–´ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò, –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –ò –í–í–û–î–ê –•–û–î–ê ---
    // ---------------------------------------------------------------------

    /**
     * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ board —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ boardSize –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ –ø—Ä–æ–±–µ–ª–∞–º–∏.
     */
    private static void initializeBoard() {
        board = new char[boardSize][boardSize];
        for (int i = 0; i < boardSize; i++) {
            Arrays.fill(board[i], ' ');
        }
    }

    /**
     * –í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
     */
    private static void printBoard() {
        System.out.println("\n--- –¢–µ–∫—É—â–µ–µ –ø–æ–ª–µ (" + boardSize + "x" + boardSize + ") ---");
        for (int i = 0; i < boardSize; i++) { // –¶–∏–∫–ª –ø–æ —Å—Ç—Ä–æ–∫–∞–º
            System.out.print("|");
            for (int j = 0; j < boardSize; j++) { // –¶–∏–∫–ª –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
                System.out.print(" " + board[i][j] + " |");
            }
            System.out.println();
            // –ü–µ—á–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (–∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏)
            if (i < boardSize - 1) {
                for(int k = 0; k < boardSize; k++) System.out.print("----");
                System.out.println("-");
            }
        }
        System.out.println("--------------------------------\n");
    }

    /**
     * –°—á–∏—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ –æ—Ç –∏–≥—Ä–æ–∫–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∫–æ–¥—ã ("JAVA", "EXIT") –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —á–∏—Å–ª–æ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
     * –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ.
     * @return –ú–∞—Å—Å–∏–≤ int[2]: [—Å—Ç—Ä–æ–∫–∞, —Å—Ç–æ–ª–±–µ—Ü], [-1, -1] –¥–ª—è "JAVA" –∏–ª–∏ [-2, -2] –¥–ª—è "EXIT".
     */
    private static int[] getPlayerMove() {
        int maxCell = boardSize * boardSize;

        System.out.print("–ò–≥—Ä–æ–∫ " + currentPlayer + ", –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —è—á–µ–π–∫–∏ (1-" + maxCell + ") –∏–ª–∏ EXIT: ");

        String input = SCANNER.next().trim();

        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–∞—Å—Ö–∞–ª–∫—É
        if (input.toUpperCase().equals("JAVA")) {
            return new int[]{-1, -1};
        }

        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–æ—Å—Ä–æ—á–Ω—ã–π –≤—ã—Ö–æ–¥
        if (input.toUpperCase().equals("EXIT")) {
            return new int[]{-2, -2};
        }

        // 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–ª–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
        try {
            int cellNumber = Integer.parseInt(input);

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
            if (cellNumber < 1 || cellNumber > maxCell) {
                System.out.println("‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ " + maxCell + ".");
                return getPlayerMove(); // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Ä–µ–∫—É—Ä—Å–∏—è)
            }

            // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ (1-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è) –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–∞—Å—Å–∏–≤–∞ (0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è)
            int index = cellNumber - 1;
            int row = index / boardSize; // –°—Ç—Ä–æ–∫–∞: —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ
            int col = index % boardSize; // –°—Ç–æ–ª–±–µ—Ü: –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è

            return new int[]{row, col};

        } catch (NumberFormatException e) {
            System.out.println("‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ (1-" + maxCell + "), 'JAVA' –∏–ª–∏ 'EXIT'.");
            return getPlayerMove(); // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Ä–µ–∫—É—Ä—Å–∏—è)
        }
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ö–æ–¥ –¥–æ–ø—É—Å—Ç–∏–º—ã–º (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–æ–ª—è –∏ —è—á–µ–π–∫–∞ –ø—É—Å—Ç–∞).
     */
    private static boolean isValidMove(int row, int col) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
        if (row < 0 || row >= boardSize || col < 0 || col >= boardSize) {
            return false;
        }
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —è—á–µ–π–∫–∞ –ø—É—Å—Ç–∞
        return board[row][col] == ' ';
    }

    /**
     * –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ —Å 'X' –Ω–∞ 'O' –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.
     */
    private static void switchPlayer() {
        currentPlayer = (currentPlayer == 'X') ? 'O' : 'X';
    }

    // -----------------------------------------------------------------------
    // --- –ú–ï–¢–û–î–´ –ü–†–û–í–ï–†–ö–ò –°–û–°–¢–û–Ø–ù–ò–Ø –ò–ì–†–´ (–û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ê–Ø –õ–û–ì–ò–ö–ê) ---
    // -----------------------------------------------------------------------

    /**
     * –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–±–µ–¥—ã.
     */
    private static boolean checkWin() {
        return (checkRows() || checkColumns() || checkDiagonals());
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ winLength –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç winLength –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ N-–≤-—Ä—è–¥ –Ω–∞ –ø–æ–ª–µ N x N.
     */
    private static boolean checkRows() {
        for (int i = 0; i < boardSize; i++) { // –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫
            // –¶–∏–∫–ª j –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –ø–æ–±–µ–¥–Ω–æ–π –ª–∏–Ω–∏–∏.
            // –£—Å–ª–æ–≤–∏–µ j <= boardSize - winLength –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –≤—ã–π–¥–µ—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞.
            for (int j = 0; j <= boardSize - winLength; j++) {
                boolean win = true;
                // –¶–∏–∫–ª k –ø—Ä–æ–≤–µ—Ä—è–µ—Ç winLength —è—á–µ–µ–∫ –ø–æ–¥—Ä—è–¥, –Ω–∞—á–∏–Ω–∞—è —Å board[i][j].
                for (int k = 0; k < winLength; k++) {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞: board[i][j+k] - –¥–≤–∏–≥–∞–µ–º—Å—è –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
                    if (board[i][j + k] != currentPlayer) {
                        win = false; // –ù–∞–π–¥–µ–Ω–æ –æ—Ç–ª–∏—á–∏–µ
                        break;
                    }
                }
                if (win) return true; // –ü–æ–±–µ–¥–∞ –Ω–∞–π–¥–µ–Ω–∞
            }
        }
        return false;
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ winLength –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏.
     */
    private static boolean checkColumns() {
        for (int j = 0; j < boardSize; j++) { // –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
            // –¶–∏–∫–ª i –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞—á–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ–±–µ–¥–Ω–æ–π –ª–∏–Ω–∏–∏.
            // –£—Å–ª–æ–≤–∏–µ i <= boardSize - winLength –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –≤—ã–π–¥–µ—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞.
            for (int i = 0; i <= boardSize - winLength; i++) {
                boolean win = true;
                // –¶–∏–∫–ª k –ø—Ä–æ–≤–µ—Ä—è–µ—Ç winLength —è—á–µ–µ–∫ –ø–æ–¥—Ä—è–¥, –Ω–∞—á–∏–Ω–∞—è —Å board[i][j].
                for (int k = 0; k < winLength; k++) {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞: board[i+k][j] - –¥–≤–∏–≥–∞–µ–º—Å—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º
                    if (board[i + k][j] != currentPlayer) {
                        win = false;
                        break;
                    }
                }
                if (win) return true;
            }
        }
        return false;
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ winLength –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥ –ø–æ –æ–±–µ–∏–º –¥–∏–∞–≥–æ–Ω–∞–ª—è–º.
     */
    private static boolean checkDiagonals() {
        // –£—Å–ª–æ–≤–∏–µ i/j <= boardSize - winLength –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–∫–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ N x N –ø–æ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–ª–µ.

        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–∞–≤–Ω–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª–∏ (—Å–≤–µ—Ä—Ö—É-—Å–ª–µ–≤–∞ –≤–Ω–∏–∑-–≤–ø—Ä–∞–≤–æ)
        for (int i = 0; i <= boardSize - winLength; i++) {
            for (int j = 0; j <= boardSize - winLength; j++) {
                boolean win = true;
                for (int k = 0; k < winLength; k++) {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞: (i+k, j+k)
                    if (board[i + k][j + k] != currentPlayer) {
                        win = false;
                        break;
                    }
                }
                if (win) return true;
            }
        }

        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–æ—á–Ω–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª–∏ (—Å–≤–µ—Ä—Ö—É-—Å–ø—Ä–∞–≤–∞ –≤–Ω–∏–∑-–≤–ª–µ–≤–æ)
        for (int i = 0; i <= boardSize - winLength; i++) {
            // j –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å (winLength - 1), —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å winLength —è—á–µ–µ–∫ —Å–ª–µ–≤–∞ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ j.
            for (int j = winLength - 1; j < boardSize; j++) {
                boolean win = true;
                for (int k = 0; k < winLength; k++) {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞: (i+k, j-k)
                    if (board[i + k][j - k] != currentPlayer) {
                        win = false;
                        break;
                    }
                }
                if (win) return true;
            }
        }
        return false;
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ª–∏ –≤—Å–µ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ (—É—Å–ª–æ–≤–∏–µ –¥–ª—è –Ω–∏—á—å–µ–π).
     */
    private static boolean isBoardFull() {
        // –ü–æ–∏—Å–∫ –ø—É—Å—Ç–æ–π —è—á–µ–π–∫–∏
        for (int i = 0; i < boardSize; i++) {
            for (int j = 0; j < boardSize; j++) {
                if (board[i][j] == ' ') {
                    return false; // –ù–∞–π–¥–µ–Ω–∞ –ø—É—Å—Ç–∞—è —è—á–µ–π–∫–∞, –Ω–∏—á—å–µ–π –Ω–µ—Ç
                }
            }
        }
        return true; // –¶–∏–∫–ª—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã, –ø–æ–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ - –Ω–∏—á—å—è
    }
}
